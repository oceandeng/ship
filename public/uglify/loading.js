"use strict";var loading=function(a){function b(a){this.page_body=document.getElementsByTagName("body")[0],this.init(a)}var c=function(a){var b;for(b in a)return!1;return!0},d=function(a,b,c,d){a.beginPath(),a.arc(b-d,c-d,d,0,Math.PI/2),a.lineTo(d,c),a.arc(d,c-d,d,Math.PI/2,Math.PI),a.lineTo(0,d),a.arc(d,d,d,Math.PI,3*Math.PI/2),a.lineTo(b-d,0),a.arc(b-d,d,d,3*Math.PI/2,2*Math.PI),a.closePath()},e=function(a,b,c,e,f,g,h){2*g>e||2*g>f||(a.save(),a.translate(b,c),d(a,e,f,g),a.fillStyle=h||"black",a.globalAlpha=.5,a.fill(),a.restore())};return b.prototype={constructor:b,init:function(a){var b=!c(a);this.id=b&&a.id?a.id:"loading",this.block=b&&a.block?a.block:12,this.height=b&&a.height?a.height:15,this.width=b&&a.width?a.width:3,this.time=b&&a.time?a.time:100},start:function(){for(var a=!0,b=this.page_body.childNodes,c=0,d=b.length;d>c;c++)a="canvas"!=b[c].nodeName.toLowerCase()||"loading"!=b[c].id;a&&(this.createDom(),this.setStyle(),this.draw())},createDom:function(){this.canvas=document.createElement("canvas"),this.offcanvas=document.createElement("canvas"),this.page_body.appendChild(this.canvas)},setStyle:function(){this.canvas.id=this.id,this.canvas.width=this.offcanvas.width=160,this.canvas.height=this.offcanvas.height=160,this.canvas.style.width=this.offcanvas.style.width="80px",this.canvas.style.height=this.offcanvas.style.height="80px",this.canvas.style.position="fixed",this.canvas.style.top="20%",this.canvas.style.left="50%",this.canvas.style.marginLeft="-40px"},draw:function(){this.ctx=this.canvas.getContext("2d"),this.offctx=this.offcanvas.getContext("2d"),this.offctx.width=6*this.height,this.offctx.height=6*this.height,this.offctx.translate(this.offctx.width/1.5,this.offctx.height/1.5);var a=2;this.view(a)},loop:function(a){this.offctx.rotate(2*Math.PI/this.block),this.offctx.beginPath(),this.offctx.fillStyle="rgba(255,255,255,"+a+")",this.offctx.arc(0,this.offctx.width/2-2*this.height,this.width/2,0,Math.PI,!0),this.offctx.arc(0,this.offctx.width/2-this.height,this.width/2,Math.PI,0,!0),this.offctx.closePath(),this.offctx.fill()},view:function(a){var b=this;this.offctx.rotate(2*Math.PI/this.block),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),e(this.ctx,0,0,this.canvas.width,this.canvas.height,10),this.ctx.drawImage(this.offcanvas,0,0),this.offctx.clearRect(-this.offctx.width/2,-this.offctx.height/2,this.offctx.width,this.offctx.height),a>=this.block?a=1:a+=1;for(var c=1;c<=this.block;c++)this.loop(c/this.block);this.timeout=setTimeout(function(){b.view(a)},b.time)},removeDom:function(){for(var a=this,b=!0,c=this.page_body.childNodes,d=0,e=c.length;e>d;d++)b="canvas"!=c[d].nodeName.toLowerCase()||"loading"!=c[d].id;b||(this.canvas.parentNode.removeChild(this.canvas),clearTimeout(a.timeout))},close:function(){this.removeDom()}},new b(a)},load=loading({width:5,height:20});$("#demo").on("click",function(){load.start()}),$("#menu").on("click",function(){load&&load.close()});